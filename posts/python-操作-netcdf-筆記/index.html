<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 8.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/gg.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/gg.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/gg.png">
  <link rel="mask-icon" href="/images/gg.png" color="#222">
  <meta name="google-site-verification" content="J5sjnNRD2AYPWVE08_-8XO_8mBKRYD3NKVYRBCGMwQ8">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">



<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S5ZWC157GD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-S5ZWC157GD');
</script>

<style>
    @font-face {
        /* font-family: "JasonHandwriting1-Regular"; */
/*
        src: url(https://cdn.jsdelivr.net/gh/max32002/JasonHandWritingFonts@20210716/webfont/JasonHandwriting1-Regular.woff2) format("woff2"), url(https://cdn.jsdelivr.net/gh/max32002/JasonHandWritingFonts@20210716/webfont/JasonHandwriting1-Regular.woff) format("woff");
		*/

        font-family: "ä¿æ–¹é«”11è™Ÿ";
        src: url(/fonts/Cubic_11_1.000_R.woff) format("woff")
    }
</style>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.blog.lasai.com.tw","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"default"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="&nbsp;">
<meta property="og:type" content="article">
<meta property="og:title" content="python æ“ä½œ netcdf ç­†è¨˜">
<meta property="og:url" content="https://www.blog.lasai.com.tw/posts/python-%E6%93%8D%E4%BD%9C-netcdf-%E7%AD%86%E8%A8%98/index.html">
<meta property="og:site_name" content="ğŸŒ¹ å–‡è³½çš„äºº Blog ğŸŒ¹">
<meta property="og:description" content="&nbsp;">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://raw.githubusercontent.com/weber87na/flowers/master/weather.jpg">
<meta property="article:published_time" content="2022-08-12T20:18:02.000Z">
<meta property="article:modified_time" content="2025-02-19T09:29:19.093Z">
<meta property="article:author" content="ğŸŒ¹ å–‡è³½äºº ğŸŒ¹">
<meta property="article:tag" content="GIS">
<meta property="article:tag" content="netcdf">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/weber87na/flowers/master/weather.jpg">

<link rel="canonical" href="https://www.blog.lasai.com.tw/posts/python-%E6%93%8D%E4%BD%9C-netcdf-%E7%AD%86%E8%A8%98/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-TW'
  };
</script>

  <title>python æ“ä½œ netcdf ç­†è¨˜ | ğŸŒ¹ å–‡è³½çš„äºº Blog ğŸŒ¹</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S5ZWC157GD"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-S5ZWC157GD');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  <!-- google ad -->
  <!--
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1069539516107706"
     crossorigin="anonymous"></script>
  -->
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <!--
  <div class="spell" ></div>
  <div class="ghost" style="display: none;"></div>
  <div class="noise"></div>
  <div class="noise2"></div>
  -->


  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ›å°èˆªæ¬„">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ğŸŒ¹ å–‡è³½çš„äºº Blog ğŸŒ¹</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">ğŸŒ¹ å–‡ä½å–‡è³½ ğŸŒ¹</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>çœŸå–‡è³½</a>

  </li>
        <li class="menu-item menu-item-map">

    <a href="/map/" rel="section"><i class="fa fa-map fa-fw"></i>å–‡è³½äººçš„å¥‡æ€ªç¾é£Ÿåœ°åœ–</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>é—œæ–¼å–‡è³½äºº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>å–‡è³½çš„æ¨™ç±¤</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å–‡è³½äº‚å¯«</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœå°‹
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœå°‹..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://www.blog.lasai.com.tw/posts/python-%E6%93%8D%E4%BD%9C-netcdf-%E7%AD%86%E8%A8%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="ğŸŒ¹ å–‡è³½äºº ğŸŒ¹">
      <meta itemprop="description" content="ğŸŒ¹ å–‡è³½äººçš„ Blog ğŸŒ¹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ğŸŒ¹ å–‡è³½çš„äºº Blog ğŸŒ¹">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          python æ“ä½œ netcdf ç­†è¨˜
        </h1>

        <div class="post-meta">
		
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">äº‚å¯«æ–¼</span>

              <time title="äº‚å…¥æ™‚é–“ï¼š2022-08-13 04:18:02" itemprop="dateCreated datePublished" datetime="2022-08-13T04:18:02+08:00">2022-08-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°æ–¼</span>
                <time title="ä¿®æ”¹æ™‚é–“ï¼š2025-02-19 17:29:19" itemprop="dateModified" datetime="2025-02-19T17:29:19+08:00">2025-02-19</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/posts/python-%E6%93%8D%E4%BD%9C-netcdf-%E7%AD%86%E8%A8%98/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="posts/python-æ“ä½œ-netcdf-ç­†è¨˜/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="å»¢è©±å­—æ•¸">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">å»¢è©±å­—æ•¸ï¼š</span>
              <span>11k</span>
            </span>
            <span class="post-meta-item" title="æ‰€éœ€å‚·çœ¼æ™‚é–“">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">æ‰€éœ€å‚·çœ¼æ™‚é–“ &asymp;</span>
              <span>10 åˆ†é˜</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>&nbsp;<br><img data-src="https://raw.githubusercontent.com/weber87na/flowers/master/weather.jpg" alt="netcdf"></p>
<span id="more"></span>

<p>ç¤™æ–¼æŸå¹´æ¥è§¸åˆ°é€™å€‹è©²æ­»çš„æª”æ¡ˆæ ¼å¼ , å¾Œä¾†ä¸‰ä¸äº”æ™‚å°±æœƒæœ‰äººä¾†ç…©æˆ‘ , ä¸éä»¥å‰æ˜¯ç”¨ ncl é€™å€‹é¬¼èªè¨€å»æé€™äº›æ±è¥¿<br>é‚£å€‹ç’°å¢ƒå¯¦åœ¨å¤ªéº»ç…©äº† , å‰›å¥½æœ‰äººæ‰¾æˆ‘å°±æŠŠé€™äº›æ–¹æ³•æ›æˆ python ç­†è¨˜ä¸‹ , ä¸ç„¶é€™å€‹é¬¼ç©æ„å¯¦åœ¨æœ‰å¤ å†·é–€ , æ¯æ¬¡åšæ¯æ¬¡å¿˜<br>ä¸‹æ¬¡æœ‰ç©ºå†æŠŠä»¥å‰ ncl çš„æŒ–å‡ºä¾†å¯«ä¸€å¯«å¥½äº†</p>
<h2 id="ç’°å¢ƒæº–å‚™"><a href="#ç’°å¢ƒæº–å‚™" class="headerlink" title="ç’°å¢ƒæº–å‚™"></a>ç’°å¢ƒæº–å‚™</h2><h3 id="ä¸‹è¼‰-Panpoly"><a href="#ä¸‹è¼‰-Panpoly" class="headerlink" title="ä¸‹è¼‰ Panpoly"></a>ä¸‹è¼‰ Panpoly</h3><p>å…ˆåˆ° NASA ä¸‹è¼‰æœ€æ–°ç‰ˆæœ¬ 5.1.1<br><a target="_blank" rel="noopener" href="https://www.giss.nasa.gov/tools/panoply/download/">https://www.giss.nasa.gov/tools/panoply/download/</a><br><code>ç‰¹åˆ¥æ³¨æ„é›»è…¦ä¸€å®šè¦æœ‰ java 11 æ‰èƒ½è·‘!</code></p>
<h3 id="å®‰è£åŠè¨­å®š-OpenJDK11"><a href="#å®‰è£åŠè¨­å®š-OpenJDK11" class="headerlink" title="å®‰è£åŠè¨­å®š OpenJDK11"></a>å®‰è£åŠè¨­å®š OpenJDK11</h3><p>é€™è£¡ç”¨å¾®è»Ÿçš„ <a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-tw/java/openjdk/download">OpenJdk 11</a><br>æ¥è‘—åœ¨ç’°å¢ƒè®Šæ•¸ <code>Path</code> åŠ ä¸Šé€™æ¨£ <code>C:\Program Files\OpenJDK\jdk-11.0.15+10\bin</code><br>ç„¶å¾Œæ–°å¢ <code>JAVA_HOME</code> è¨­å®šé€™æ¨£ <code>C:\Program Files\OpenJDK\jdk-11.0.15+10\bin</code></p>
<h3 id="Panpoly-æ“ä½œèªªæ˜"><a href="#Panpoly-æ“ä½œèªªæ˜" class="headerlink" title="Panpoly æ“ä½œèªªæ˜"></a>Panpoly æ“ä½œèªªæ˜</h3><p>ç¤™æ–¼ Panpoly æ“ä½œèˆ‡ä¹‹å‰ä¸å¤ªä¸€æ¨£ , é€™é‚Šé †ä¾¿å¸¶ä¸€ä¸‹<br>é»é¸ <code>File</code> &#x3D;&gt; <code>Open</code> &#x3D;&gt; <code>YOURNETCDF.nc</code> &#x3D;&gt; <code>é»é¸è®Šæ•¸</code> &#x3D;&gt; <code>å³éµ</code> &#x3D;&gt; <code>Create Plot</code> &#x3D;&gt;<br><code>æ¥è‘—é»é¸ Georeferenced Longitude-Latitude color contour plot</code> &#x3D;&gt; <code>Create</code><br>å»ºç«‹åœ°åœ–å¾Œ , æœƒç™¼ç¾ä»¥å‰å¯ä»¥é¸æ™‚é–“çš„é¸é …ä¸è¦‹äº† , ä»–ç¾åœ¨è¢«è—åœ¨ <code>Window</code> &#x3D;&gt; <code>Arrays</code> è£¡é¢ , æƒ³é—œé–‰çš„è©±é»é¸å·¦ä¸Šè§’çš„å‰å‰<br>é¸å®Œä¹‹å¾Œæ™‚é–“çš„å°è¦–çª—å°±æœƒè·³å‡ºä¾† , æœ‰ä»»ä½•éœ€è¦ä¿®æ”¹ view çš„åœ°æ–¹å°±æ‰¾çœ‹çœ‹ <code>Window</code></p>
<h3 id="conda-æº–å‚™"><a href="#conda-æº–å‚™" class="headerlink" title="conda æº–å‚™"></a>conda æº–å‚™</h3><p><code>æ³¨æ„è¦ç”¨ Anaconda Prompt é€™å€‹ shell é–‹å•Ÿ!!</code> é–‹å•Ÿå¾Œæœƒé•·ä¸‹é¢é€™æ¨£</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(base) â”[lasai]</span><br><span class="line">â”–[~]&gt;</span><br></pre></td></tr></table></figure>

<p>æ¥è‘—æº–å‚™ <a target="_blank" rel="noopener" href="https://www.anaconda.com/products/distribution">conda</a> éœ€è¦çš„ç’°å¢ƒ , é€™é‚Šç”¨ <a target="_blank" rel="noopener" href="https://docs.xarray.dev/en/stable/">xarray</a> é€™å€‹ lib ä¾†æ“ä½œ netcdf æ‡‰è©²å¯ä»¥çœä¸å°‘äº‹<br>å¦‚æœéœ€è¦åˆä½µ netcdf è¦å¤šå®‰è£ <code>dask</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">conda env list</span><br><span class="line">conda create --name netcdf</span><br><span class="line">conda install netcdf4</span><br><span class="line">conda install xarray</span><br><span class="line">conda install pandas</span><br><span class="line">conda install numpy</span><br><span class="line">conda install dask</span><br><span class="line">conda install jupyter notebook</span><br><span class="line">conda install psycopg2</span><br><span class="line">conda install matplotlib</span><br><span class="line">conda activate netcdf</span><br></pre></td></tr></table></figure>
<p>æœ€å¾Œæœƒé•·é€™æ¨£</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(netcdf) â”[lasai]</span><br><span class="line">â”–[~]&gt;</span><br></pre></td></tr></table></figure>

<h2 id="example"><a href="#example" class="headerlink" title="example"></a>example</h2><h3 id="åŒ¯å‡ºç‚º-csv"><a href="#åŒ¯å‡ºç‚º-csv" class="headerlink" title="åŒ¯å‡ºç‚º csv"></a>åŒ¯å‡ºç‚º csv</h3><p>æœ¬ä¾†ä»¥ç‚ºæœƒå¾ˆéº»ç…© , æ²’æƒ³åˆ°å¾ˆç„¡è…¦<br>æ¯”è¼ƒéœ€è¦æ³¨æ„çš„æ˜¯è¬ä¸€ä¸è¦æœ‰ NaN çš„è³‡æ–™å¯ä»¥ç”¨ <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/39695606/querying-panda-df-to-filter-rows-where-a-column-is-not-nan"><code>dropna</code></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import xarray as xr</span><br><span class="line">import numpy as np</span><br><span class="line"></span><br><span class="line">nc = xr.open_dataset(&#x27;YOURFILE.nc&#x27;)</span><br><span class="line"></span><br><span class="line">list(nc.keys())</span><br><span class="line"></span><br><span class="line"># å¯ä»¥ç›´æ¥é€™æ¨£æ’ˆ</span><br><span class="line">nc.yourvariable.to_dataframe().to_csv(&#x27;YOURFILE.csv&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># æˆ–æ˜¯é€™æ¨£æ’ˆ</span><br><span class="line">nc[&#x27;yourvariable&#x27;].to_dataframe().to_csv(&#x27;YOURFILE.csv&#x27;)</span><br><span class="line"></span><br><span class="line"># éæ¿¾ nan</span><br><span class="line">nc.yourvariable.to_dataframe().dropna(subset=[&#x27;yourvariable&#x27;]).to_csv(&#x27;YOURFILE.csv&#x27;)</span><br><span class="line"></span><br><span class="line"># ä¸€æ¬¡æ’ˆå¤šå€‹</span><br><span class="line">df = nc.to_dataframe()</span><br><span class="line">df.dropna(subset=[&#x27;var1&#x27;,&#x27;var2&#x27;]).to_csv(&#x27;test.csv&#x27;)</span><br></pre></td></tr></table></figure>

<h3 id="åˆä½µ-netcdf"><a href="#åˆä½µ-netcdf" class="headerlink" title="åˆä½µ netcdf"></a>åˆä½µ netcdf</h3><p>æˆ‘æœ‰æ•¸å€‹æœˆçš„ netcdf è³‡æ–™é¡ä¼¼é€™æ¨£çš„çµæ§‹ <code>YOURNETCDF\2020</code> , å¸Œæœ›å¯ä»¥åˆæˆä¸€å€‹å–®æª”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">------      2021/7/19  ä¸‹åˆ 05:22       12883288 ï…›  YOURNETCDF_202001.nc</span><br><span class="line">------      2021/7/19  ä¸‹åˆ 05:22       14316965 ï…›  YOURNETCDF_202002.nc</span><br><span class="line">------      2021/7/19  ä¸‹åˆ 05:22       15383188 ï…›  YOURNETCDF_202003.nc</span><br><span class="line">------      2021/7/19  ä¸‹åˆ 05:22       11371512 ï…›  YOURNETCDF_202004.nc</span><br></pre></td></tr></table></figure>

<p>åœ¨ <code>Anaconda Prompt</code> åº•ä¸‹è¼¸å…¥æŒ‡ä»¤é–‹å•Ÿ vscode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd YOURNETCDF\2020</span><br><span class="line">code .</span><br></pre></td></tr></table></figure>

<p>æ¥è‘—åˆä½µçœ‹çœ‹ , ä¸€æ¨£åœ¨ <code>YOURNETCDF\2020</code> è³‡æ–™å¤¾æ–°å¢ä¸€éš» <code>merge_netcdf.py</code><br>é€™è£¡æœ€å¤§çš„é›·æ‡‰è©²å°±æ˜¯æ²’å®‰è£ <code>dask</code> , åªè¦å®‰è£äº†å°±æ˜¯ç„¡è…¦åˆä½µ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import xarray as xr</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"># å–å¾—ç›®å‰è³‡æ–™å¤¾åç¨±</span><br><span class="line">year_name = os.path.basename(os.getcwd())</span><br><span class="line"></span><br><span class="line"># å–å¾—ä¸Šå±¤ç›®éŒ„çš„çµ•å°è·¯å¾‘</span><br><span class="line">prev_dir_name = os.path.abspath(os.path.join(os.getcwd(), os.path.pardir))</span><br><span class="line"></span><br><span class="line"># éæ¿¾å‡ºè®Šæ•¸åç¨±</span><br><span class="line">variable_name = os.path.basename(prev_dir_name)</span><br><span class="line"></span><br><span class="line"># åˆæˆå®Œæ•´åç¨±</span><br><span class="line">full_name = f&quot;&#123;variable_name&#125;_&#123;year_name&#125;.nc&quot;</span><br><span class="line"># print(full_name)</span><br><span class="line"></span><br><span class="line"># éœ€å…ˆå®‰è£ dask æ¨¡çµ„</span><br><span class="line"># conda install dask</span><br><span class="line">ds = xr.open_mfdataset(&#x27;*.nc&#x27;, parallel=True)</span><br><span class="line"></span><br><span class="line">ds.to_netcdf(full_name)</span><br></pre></td></tr></table></figure>

<p>æœ€å¾ŒåŸ·è¡Œ <code>merge_netcdf_demo.py</code> çœ‹çœ‹æ‡‰è©²æœƒå¾—åˆ°ä»¥ä¸‹çµæœ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-a----       2022/7/31  ä¸Šåˆ 11:19      186940159 ï…›  YOURNETCDF_2020.nc</span><br></pre></td></tr></table></figure>

<p>æ¥è‘—é–‹å•Ÿ <code>Panpoly</code> ä¾†é©—è­‰æ˜¯å¦æ­£ç¢ºåˆä½µäº†<br>é»é¸ <code>File</code> &#x3D;&gt; <code>Open</code> &#x3D;&gt; <code>YOURNETCDF_2020.nc</code> &#x3D;&gt; <code>é»é¸è®Šæ•¸</code> &#x3D;&gt; <code>å³éµ</code> &#x3D;&gt; <code>Create Plot</code><br>æ¥è‘—é»é¸ <code>Georeferenced Longitude-Latitude color contour plot</code> &#x3D;&gt; <code>Create</code><br>æ¥è‘—é»é¸ <code>Window</code> &#x3D;&gt; <code>Arrays</code> å¯ä»¥çœ‹åˆ°ç¾åœ¨æœ‰ 365 å¤©äº†</p>
<h3 id="ä¿®å¾©æ™‚é–“-Coordinates"><a href="#ä¿®å¾©æ™‚é–“-Coordinates" class="headerlink" title="ä¿®å¾©æ™‚é–“ Coordinates"></a>ä¿®å¾©æ™‚é–“ Coordinates</h3><p>ä»Šå¤©æ‹¿åˆ°ä¸€ä»½æª”æ¡ˆ , æœ¬ä¾†ä¹‹å‰çš„è³‡æ–™éƒ½æ­£å¸¸ work , ååé€™ä»½å‡ºäº†å•é¡Œ , æ‹¿ jupyter è·Ÿ Panpoly debug çœ‹çœ‹ , ç™¼ç¾æ˜¯æ™‚é–“çš„ Coordinates æœ‰å•é¡Œ<br>é€™å€‹åœ¨è½‰è³‡æ–™æˆ–æ˜¯è£½ä½œè³‡æ–™æ™‚ , æ‡‰è©²è¦æŠŠ <code>date</code> é€™å€‹è®Šæ•¸æ”¾åœ¨ <code>Coordinates</code> è£¡é¢æ‰å°<br>ç¥å¥‡çš„æ˜¯ , ç”¨ Panpoly ä¹Ÿæ˜¯å¯ä»¥é¸æ“‡æ™‚é–“é€™å€‹ç¶­åº¦ , åªä¸éé¡¯ç¤ºçš„æ˜¯ 1 - 31 , ä¸¦éæ­£å¸¸çš„æ™‚é–“<br>æˆ‘é™¸çºŒçœ‹äº†å¹¾å€‹ api <code>expand_dims</code> , <code>assign_coords</code> ä¸‹å» try , ä¸ééƒ½æ²’æˆåŠŸ , æ‰€ä»¥ç”¨ä»¥ä¸‹æ¯”è¼ƒè ¢çš„æ–¹æ³•å»åš</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># è®€å– netcdf</span><br><span class="line">nc = xr.open_dataset(&#x27;XXX.nc&#x27;)</span><br><span class="line">nc</span><br></pre></td></tr></table></figure>
<p>è¼¸å‡ºå¦‚ä¸‹çµæœ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Dimensions:</span><br><span class="line">	time: 31 latitude: 409 longitude: 313</span><br><span class="line">Coordinates:</span><br><span class="line">	latitude (latitude) float32 ...</span><br><span class="line">	longitude (longitude) float32 ...</span><br><span class="line">Data variables:</span><br><span class="line">	date (time) float32 ...</span><br><span class="line">	othervar (time, latitude, longitude) float32 ...</span><br><span class="line">	othervar2 (time, latitude, longitude) float32 ...</span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¦è®Šæˆæ­£å¸¸æ ¼å¼æ‡‰è©²æœƒé•·é€™æ¨£ , ç‰¹åˆ¥æ³¨æ„ <code>xarray</code> æ™‚é–“é€šå¸¸éƒ½æ˜¯ <code>datetime64[ns]</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Dimensions:</span><br><span class="line">	time: 31 latitude: 409 longitude: 313</span><br><span class="line">Coordinates:</span><br><span class="line">	time (time) datetime64[ns] ...</span><br><span class="line">	latitude (latitude) float32 ...</span><br><span class="line">	longitude (longitude) float32 ...</span><br><span class="line">Data variables:</span><br><span class="line">	othervar (time, latitude, longitude) float32 ...</span><br><span class="line">	othervar2 (time, latitude, longitude) float32 ...</span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆå»ºç«‹æ™‚é–“é€™å€‹ dataframe , å¯ä»¥åƒè€ƒ<a target="_blank" rel="noopener" href="https://pandas.pydata.org/docs/reference/api/pandas.to_datetime.html">é€™è£¡</a><br>æˆ‘é€™è£¡æ–¹æ³•å¯èƒ½æ¯”è¼ƒè ¢ , python å¯«å¾—æ–·æ–·çºŒçºŒ , æ‰€ä»¥å°±ç›´æ¥ for loop<br>å‡è¨­æ™‚é–“æ˜¯ <code>2008-01-01</code> è‡³ <code>2008-01-31</code> å¯ä»¥é€™æ¨£å¯«</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import xarray as xr</span><br><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line">import pandas.io.sql as sqlio</span><br><span class="line"></span><br><span class="line"># è®€å– netcdf</span><br><span class="line">nc = xr.open_dataset(&#x27;BADFILE.nc&#x27;)</span><br><span class="line"># nc</span><br><span class="line"></span><br><span class="line"># æ‰‹å‹•åŠ å…¥æ™‚é–“</span><br><span class="line">newyear = []</span><br><span class="line">newmonth = []</span><br><span class="line">newdate = []</span><br><span class="line">newminute = []</span><br><span class="line"></span><br><span class="line"># 31 å¤©</span><br><span class="line">print(len(nc.date))</span><br><span class="line"></span><br><span class="line">for x in nc.date:</span><br><span class="line">    newyear.append(2008)</span><br><span class="line">    newmonth.append(1)</span><br><span class="line">    newdate.append(int(x))</span><br><span class="line">    # é€™è£¡æ²’å°æ™‚å¯ä»¥è¨­å®š , æ‰€ä»¥è¦é€™æ¨£å¯«</span><br><span class="line">    # format like this 2008-01-01 12:00:00</span><br><span class="line">    newminute.append(int(60 * 12))</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;&#x27;year&#x27;: newyear, &#x27;month&#x27;: newmonth, &#x27;day&#x27;: newdate , &#x27;minute&#x27;: newminute&#125;)</span><br><span class="line">newfulltime = pd.to_datetime(df)</span><br></pre></td></tr></table></figure>

<p>æ¥è‘—æ’ˆå‡º <code>è®Šæ•¸</code> èˆ‡ <code>global å±¬æ€§</code> åŠ <code>ç¶“ç·¯åº¦</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># å–å¾—ç¶“ç·¯åº¦</span><br><span class="line">lat = nc[&#x27;latitude&#x27;].values</span><br><span class="line">lon = nc[&#x27;longitude&#x27;].values</span><br><span class="line"></span><br><span class="line"># æ’ˆè®Šæ•¸</span><br><span class="line">othervar = nc.othervar.values</span><br><span class="line">othervar2 = nc.othervar2.values</span><br><span class="line"></span><br><span class="line"># å–å¾— global å±¬æ€§</span><br><span class="line">att = nc.attrs</span><br></pre></td></tr></table></figure>

<p>é‡å°æ¯å€‹è®Šæ•¸å»ºç«‹ DataArray</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># å»ºç«‹ DataArray</span><br><span class="line">new_othervar = xr.DataArray(</span><br><span class="line">othervar,</span><br><span class="line">coords=&#123;</span><br><span class="line">	&#x27;time&#x27;: newfulltime,</span><br><span class="line">	&#x27;latitude&#x27;: lat,</span><br><span class="line">	&#x27;longitude&#x27;: lon</span><br><span class="line">&#125;,</span><br><span class="line">dims=[&#x27;time&#x27;, &#x27;latitude&#x27;, &#x27;longitude&#x27;],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># å»ºç«‹ DataArray</span><br><span class="line">new_othervar2 = xr.DataArray(</span><br><span class="line">othervar2,</span><br><span class="line">coords=&#123;</span><br><span class="line">	&#x27;time&#x27;: newfulltime,</span><br><span class="line">	&#x27;latitude&#x27;: lat,</span><br><span class="line">	&#x27;longitude&#x27;: lon</span><br><span class="line">&#125;,</span><br><span class="line">dims=[&#x27;time&#x27;, &#x27;latitude&#x27;, &#x27;longitude&#x27;],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>æœ€å¾Œé‡å»ºæª”æ¡ˆ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># é‡å»º netcdf æª”æ¡ˆ</span><br><span class="line">newds = xr.Dataset(</span><br><span class="line">    data_vars=dict(</span><br><span class="line">        othervar = new_othervar,</span><br><span class="line">        othervar2 = new_othervar2</span><br><span class="line">    ),</span><br><span class="line">    attrs=att,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># ä»–é€™å€‹æœ‰æŒ‡å®šç”¨ NETCDF4 å»å­˜æª”</span><br><span class="line">newds.to_netcdf(&#x27;FIXFILE.nc&#x27;,format=&#x27;NETCDF4&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># è®€å–æ–°æå‡ºä¾†çš„æª”æ¡ˆ</span><br><span class="line">newnc = xr.open_dataset(&#x27;FIXFILE.nc&#x27;)</span><br><span class="line"># newnc</span><br></pre></td></tr></table></figure>

<h3 id="ä¿®å¾©æ™‚é–“-Coordinates-part2"><a href="#ä¿®å¾©æ™‚é–“-Coordinates-part2" class="headerlink" title="ä¿®å¾©æ™‚é–“ Coordinates part2"></a>ä¿®å¾©æ™‚é–“ Coordinates part2</h3><p>é€™æ¬¡é‡åˆ°ä¸€æ‰¹è³‡æ–™æ ¼å¼ç‚º <code>yymmddHH</code> , æœ¬ä¾†æ²’è©³ç´°çœ‹ , ä¹Ÿä¸æ›‰å¾—å•é¡Œåœ¨å“ª , è™•ç†è€åŠå¤© , åœ–è³‡ server ååå…éŒ¢åªåƒæ¨™æº– format ç‹‚å™´ç´…å­—<br>å¾Œä¾†æ‰ç™¼ç¾ä»–çš„æ—¥æœŸæ ¼å¼æ€ªæ€ª , å› ç‚ºä¸€æ™‚ä¹Ÿæƒ³ä¸å‡ºå•¥å¥½æ³•å­ , å°±ç›´æ¥æ“·å– string å»é€ä¸€è™•ç† , é‚„å¥½æœ€å¾Œå±é‹æå®š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">import xarray as xr</span><br><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line"># å»ºç«‹ DataArray</span><br><span class="line">def createDataArray(var, newfulltime, lat , lon):</span><br><span class="line">    new_var = xr.DataArray(</span><br><span class="line">        var,</span><br><span class="line">        coords=&#123;</span><br><span class="line">            &#x27;time&#x27;: newfulltime,</span><br><span class="line">            &#x27;latitude&#x27;: lat,</span><br><span class="line">            &#x27;longitude&#x27;: lon</span><br><span class="line">        &#125;,</span><br><span class="line">        dims=[&#x27;time&#x27;, &#x27;latitude&#x27;, &#x27;longitude&#x27;],</span><br><span class="line">    )</span><br><span class="line">    return new_var</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># è®€æª”</span><br><span class="line">nc = xr.open_dataset(&#x27;xxx.nc&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ä¿®æ­£æ™‚é–“ yymmddHH è½‰ç‚ºæ­£å¼çš„æ™‚é–“æ ¼å¼</span><br><span class="line">time = nc[&#x27;Time&#x27;]</span><br><span class="line"># print(time)</span><br><span class="line">new_years = []</span><br><span class="line">new_months = []</span><br><span class="line">new_days = []</span><br><span class="line">new_times = []</span><br><span class="line"></span><br><span class="line">for x in time:</span><br><span class="line">    val = x.values</span><br><span class="line">    s = str(int(val))</span><br><span class="line">    new_year = int(f&#x27;20&#123;s[0:2]&#125;&#x27;)</span><br><span class="line">    new_month = int(s[2:4])</span><br><span class="line">    new_day = int(s[4:6])</span><br><span class="line">    new_time = int(s[6:8])</span><br><span class="line">    new_years.append(new_year)</span><br><span class="line">    new_months.append(new_month)</span><br><span class="line">    new_days.append(new_day)</span><br><span class="line">    new_times.append(int(60 * new_time))</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;&#x27;year&#x27;: new_years, &#x27;month&#x27;: new_months,</span><br><span class="line">                  &#x27;day&#x27;: new_days, &#x27;minute&#x27;: new_times&#125;)</span><br><span class="line"># æ­£ç¢ºçš„æ™‚é–“æ ¼å¼</span><br><span class="line">newfulltime = pd.to_datetime(df)</span><br><span class="line"></span><br><span class="line"># å–å¾—ç¶“ç·¯åº¦</span><br><span class="line">lat = nc[&#x27;latitude&#x27;].values</span><br><span class="line">lon = nc[&#x27;longitude&#x27;].values</span><br><span class="line"></span><br><span class="line"># æ’ˆè®Šæ•¸</span><br><span class="line">xxx = nc[&#x27;xxx&#x27;]</span><br><span class="line"></span><br><span class="line"># å–å¾— global å±¬æ€§</span><br><span class="line">att = nc.attrs</span><br><span class="line"></span><br><span class="line"># å»ºç«‹è®Šæ•¸</span><br><span class="line">new_xxx = createDataArray(xxx, newfulltime , lat , lon)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># é‡å»º netcdf æª”æ¡ˆ</span><br><span class="line">newds = xr.Dataset(</span><br><span class="line">    data_vars=dict(</span><br><span class="line">        xxx = new_xxx,</span><br><span class="line">    ),</span><br><span class="line">    attrs=att,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># ä»–é€™å€‹æœ‰æŒ‡å®šç”¨ NETCDF4 å»å­˜æª”</span><br><span class="line">newds.to_netcdf(&#x27;FIXFILE.nc&#x27;,format=&#x27;NETCDF4&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># è®€å–æ–°æå‡ºä¾†çš„æª”æ¡ˆ</span><br><span class="line">newnc = xr.open_dataset(&#x27;FIXFILE.nc&#x27;)</span><br><span class="line">print(newnc)</span><br></pre></td></tr></table></figure>

<h3 id="ä¿®å¾©-Coordinate-ä¸¦é™ç¶­"><a href="#ä¿®å¾©-Coordinate-ä¸¦é™ç¶­" class="headerlink" title="ä¿®å¾© Coordinate ä¸¦é™ç¶­"></a>ä¿®å¾© Coordinate ä¸¦é™ç¶­</h3><p>ä»Šå¤©åˆé‡åˆ°å€‹å•é¡Œ , æª”æ¡ˆåœ¨ geoserver ä¸Šé¢æ²’æ³•ç™¼ä½ˆ<br>å…ˆè®€çœ‹çœ‹è³‡æ–™ç™¼ç¾åˆæš´é›· , ä»–çš„è®Šæ•¸æŒ‡å®šåˆ° <code>lon</code> , <code>lat</code> çš„ coordinates , å¯æ˜¯å¯¦éš›ä¸Šè®Šæ•¸åˆå‘½ç‚º <code>longitude</code> , <code>latitude</code><br>é€™æ¨£æœƒé€ æˆéŒ¯èª¤éœ€è¦ä¿®å¾©</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Dimensions:    (depth: 1, lon: 157, lat: 205, time: 31)</span><br><span class="line">Coordinates:</span><br><span class="line">  * depth      (depth) float64 0.494</span><br><span class="line">  * time       (time) datetime64[ns] 1998-01-01T12:00:00 ... 1998-01-31T12:00:00</span><br><span class="line">Dimensions without coordinates: lon, lat</span><br><span class="line">Data variables:</span><br><span class="line">    longitude  (lon) float64 ...</span><br><span class="line">    latitude   (lat) float64 ...</span><br><span class="line">    vo         (time, depth, lat, lon) float64 ...</span><br></pre></td></tr></table></figure>

<p>ä¿®å¥½äº†ä»¥å¾Œç™¼ç¾é‚„æ˜¯æ²’æ³•åœ¨ geoserver ä¸Šé¢ç™¼ä½ˆ , å› ç‚ºé€™æ¬¡æœ‰å¤šå€‹ <code>depth</code> çš„ç¶­åº¦å°±èªç‚ºæ˜¯ä»–æçš„é¬¼<br>åæ­£ä»–çš„è³‡æ–™ä¹Ÿåªæœ‰ä¸€å€‹æ·±åº¦ , åŸºæœ¬ä¸Šæ²’å•¥æ„ç¾© , æ‰€ä»¥è·‘å€‹è¿´åœˆæŠŠéœ€è¦çš„æ“·å–å‡ºä¾†å³å¯</p>
<p>å¯¦ä½œ code</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">import xarray as xr</span><br><span class="line"></span><br><span class="line"># è®€å–æª”æ¡ˆ</span><br><span class="line">nc = xr.open_dataset(&#x27;xxx.nc&#x27;)</span><br><span class="line"></span><br><span class="line"># æ’ˆè®Šæ•¸</span><br><span class="line">lat = nc[&#x27;latitude&#x27;]</span><br><span class="line">lon = nc[&#x27;longitude&#x27;]</span><br><span class="line">time = nc[&#x27;time&#x27;]</span><br><span class="line">uo = nc[&#x27;uo&#x27;]</span><br><span class="line">vo = nc[&#x27;vo&#x27;]</span><br><span class="line"></span><br><span class="line"># ä¿å­˜ä¿®æ”¹å¾Œçš„è®Šæ•¸</span><br><span class="line">vos = []</span><br><span class="line">uos = []</span><br><span class="line"></span><br><span class="line"># çŒœæ¸¬é€™è£¡çš„ depth æœ‰å•é¡Œå°è‡´ geoserver ç™¼ç”ŸéŒ¯èª¤</span><br><span class="line"># ä»¥æ™‚é–“ loop é‡æ–°å–å‡ºæ•¸å€¼</span><br><span class="line">for i , ele in enumerate(time):</span><br><span class="line">    uo_val = uo[i][0][:][:]</span><br><span class="line">    vo_val = vo[i][0][:][:]</span><br><span class="line">    uos.append(uo_val)</span><br><span class="line">    vos.append(vo_val)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># åˆä½µæ¯å¤©çš„è³‡æ–™</span><br><span class="line"># https://docs.xarray.dev/en/stable/generated/xarray.concat.html</span><br><span class="line">new_uo = xr.concat(uos , dim=&#x27;time&#x27;)</span><br><span class="line"></span><br><span class="line"># ä»–é€™è£¡çš„ latitude longitude å¯«åœ¨è®Šæ•¸ä¸Šé¢ coord å¯¦éš›ä¸Šæ˜¯ç”¨ lon lat , æ‰€ä»¥é‡æ–°åˆ†é…å°±å¯ä»¥æ­£å¸¸</span><br><span class="line">new_uo = new_uo.assign_coords(&#123;</span><br><span class="line">    &quot;lon&quot; : lon,</span><br><span class="line">    &quot;lat&quot; : lat</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"># åˆä½µæ¯å¤©çš„è³‡æ–™</span><br><span class="line"># https://docs.xarray.dev/en/stable/generated/xarray.concat.html</span><br><span class="line">new_vo = xr.concat(vos , dim=&#x27;time&#x27;)</span><br><span class="line"></span><br><span class="line"># ä»–é€™è£¡çš„ latitude longitude å¯«åœ¨è®Šæ•¸ä¸Šé¢ coord å¯¦éš›ä¸Šæ˜¯ç”¨ lon lat , æ‰€ä»¥é‡æ–°åˆ†é…å°±å¯ä»¥æ­£å¸¸</span><br><span class="line">new_vo = new_vo.assign_coords(&#123;</span><br><span class="line">    &quot;lon&quot; : lon,</span><br><span class="line">    &quot;lat&quot; : lat</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"># è£½ä½œ dataset</span><br><span class="line">newds = xr.Dataset(</span><br><span class="line">    data_vars=dict(</span><br><span class="line">        uo = new_uo,</span><br><span class="line">        vo = new_vo,</span><br><span class="line">    ),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># åˆªé™¤æ²’ç”¨åˆ°çš„è®Šæ•¸</span><br><span class="line"># https://docs.xarray.dev/en/stable/generated/xarray.Dataset.drop_vars.html</span><br><span class="line">newds = newds.drop_vars(&#x27;depth&#x27;)</span><br><span class="line">newds.to_netcdf(&#x27;xxx_fix.nc&#x27;)</span><br></pre></td></tr></table></figure>

<h3 id="ä¿®å¾©-Coordinate-ä¸¦ä¸”è£œä¸Š-units"><a href="#ä¿®å¾©-Coordinate-ä¸¦ä¸”è£œä¸Š-units" class="headerlink" title="ä¿®å¾© Coordinate ä¸¦ä¸”è£œä¸Š units"></a>ä¿®å¾© Coordinate ä¸¦ä¸”è£œä¸Š units</h3><p>å»¶çºŒä¸Šå€‹ example å¾Œä¾†è¦ºå¾—ä¸è©²é´•é³¥å¿ƒæ…‹ , é€™æ¨£ä»¥å¾Œé‡åˆ°é¡ä¼¼å•é¡Œä¸å°±çˆ†ç‚¸ , ä»”ç´°çœ‹çœ‹è³‡æ–™ç™¼ç¾æ²’æœ‰ units çŒœ geoserver èªä¸å¾— , è£œä¸Šå»çœ‹çœ‹å°±æå®šäº†<br>æœ€é—œéµçš„ä¸€å¥ <code>depth.attrs[&#39;units&#39;] = &#39;m&#39;</code><br>æ¯æ¬¡è™•ç†åˆ¥äººçš„è³‡æ–™é‚„çœŸæ˜¯ç—›è‹¦è¬åˆ† , ä¸€å †å•é¡Œè¦é è‡ªå·±é€šéˆçš„ â€¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">import xarray as xr</span><br><span class="line"></span><br><span class="line"># è®€å–æª”æ¡ˆ</span><br><span class="line">nc = xr.open_dataset(&#x27;XXX.nc&#x27;)</span><br><span class="line"></span><br><span class="line"># æ’ˆè®Šæ•¸</span><br><span class="line">lat = nc[&#x27;latitude&#x27;]</span><br><span class="line">lon = nc[&#x27;longitude&#x27;]</span><br><span class="line">time = nc[&#x27;time&#x27;]</span><br><span class="line">depth = nc[&#x27;depth&#x27;]</span><br><span class="line">uo = nc[&#x27;uo&#x27;]</span><br><span class="line">vo = nc[&#x27;vo&#x27;]</span><br><span class="line"></span><br><span class="line"># é—œéµè¦è¨­å®šæ·±åº¦å–®ä½ä¸ç„¶ geoserver èªä¸å¾—ä»–</span><br><span class="line">depth.attrs[&#x27;units&#x27;] = &#x27;m&#x27;</span><br><span class="line"></span><br><span class="line"># ä»–é€™è£¡çš„ latitude longitude å¯«åœ¨è®Šæ•¸ä¸Šé¢ coord å¯¦éš›ä¸Šæ˜¯ç”¨ lon lat , æ‰€ä»¥é‡æ–°åˆ†é…å°±å¯ä»¥æ­£å¸¸</span><br><span class="line">new_uo = uo.assign_coords(&#123;</span><br><span class="line">    &quot;lon&quot; : lon,</span><br><span class="line">    &quot;lat&quot; : lat,</span><br><span class="line">    &quot;depth&quot; : depth</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"># ä»–é€™è£¡çš„ latitude longitude å¯«åœ¨è®Šæ•¸ä¸Šé¢ coord å¯¦éš›ä¸Šæ˜¯ç”¨ lon lat , æ‰€ä»¥é‡æ–°åˆ†é…å°±å¯ä»¥æ­£å¸¸</span><br><span class="line">new_vo = vo.assign_coords(&#123;</span><br><span class="line">    &quot;lon&quot; : lon,</span><br><span class="line">    &quot;lat&quot; : lat,</span><br><span class="line">    &quot;depth&quot; : depth</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"># è£½ä½œ dataset</span><br><span class="line">newds = xr.Dataset(</span><br><span class="line">    data_vars=dict(</span><br><span class="line">        depth = depth,</span><br><span class="line">        uo = new_uo,</span><br><span class="line">        vo = new_vo,</span><br><span class="line">    ),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># ä¿å­˜æª”æ¡ˆ</span><br><span class="line">newds.to_netcdf(&#x27;XXXFIX.nc&#x27;)</span><br></pre></td></tr></table></figure>


<h3 id="åŒ¯å…¥-netcdf-è³‡æ–™åˆ°-postgresql"><a href="#åŒ¯å…¥-netcdf-è³‡æ–™åˆ°-postgresql" class="headerlink" title="åŒ¯å…¥ netcdf è³‡æ–™åˆ° postgresql"></a>åŒ¯å…¥ netcdf è³‡æ–™åˆ° postgresql</h3><p>é€™å€‹çœ‹èµ·ä¾†å¥½åƒå¾ˆå›°é›£çš„ä½œæ¥­ , å…¶å¯¦éª¨å­è£¡å°±æ˜¯æŠŠè³‡æ–™å…ˆå¼„æˆ csv ç„¶å¾ŒåŒ¯é€²å»<br>å¦‚æœæ˜¯ç”¨ postgres æœ‰å€‹ç„¡è…¦çš„è³‡æ–™å‹åˆ¥ <code>precision</code> å¯ä»¥ä½¿ç”¨<br>å¦‚æœæ˜¯ sql server å°±è¦è€ƒæ…®æ¬„ä½å…¶ç²¾åº¦é€šå¸¸ <code>lon</code> æœƒè¨­å®šç‚º <code>decimal(11,8)</code> , <code>lat</code> å‰‡æ˜¯ <code>decimal(10,8)</code><br>å¦å¤–ç§å¿ƒæ¨è–¦å€‹å¥½ç”¨å·¥å…· <a target="_blank" rel="noopener" href="https://www.pgcli.com/">pgcli</a> , ç•¶åªæœ‰ cli æ™‚å¾ˆå¥½ç”¨ , ä»–ä¹Ÿæœ‰ sql server &amp; mysql çš„ç‰ˆæœ¬</p>
<p>å»ºç«‹è³‡æ–™è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create database mydb;</span><br><span class="line">create table test(</span><br><span class="line">	id bigserial primary key,</span><br><span class="line">	time timestamp,</span><br><span class="line">	lon double precision,</span><br><span class="line">	lat double precision,</span><br><span class="line">	yourvariable double precision</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>æ²’è¨˜éŒ¯çš„è©± , é€™è£¡è¦æ³¨æ„åªæœ‰ä¸€é»å°±æ˜¯ä½¿ç”¨ <code>COPY</code> æŒ‡ä»¤ <code>åªèƒ½åœ¨é‚£å°é›»è…¦ä¸Š run!!!</code><br>ç•¶ç„¶ä¹Ÿå¯ä»¥ä¸€ç­†ä¸€ç­† insert , ä½†æ˜¯ netcdf è³‡æ–™é‡å¾ˆå¤§ , æ²’äººé€™æ¨£æçš„ , å¾ˆè ¢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import psycopg2</span><br><span class="line">import xarray as xr</span><br><span class="line">import numpy as np</span><br><span class="line"></span><br><span class="line"># Update connection string information</span><br><span class="line">host = &quot;localhost&quot;</span><br><span class="line">dbname = &quot;mydb&quot;</span><br><span class="line">user = &quot;postgres&quot;</span><br><span class="line">password = &quot;postgres&quot;</span><br><span class="line">sslmode = &quot;allow&quot;</span><br><span class="line"></span><br><span class="line"># Construct connection string</span><br><span class="line">conn_string = &quot;host=&#123;0&#125; user=&#123;1&#125; dbname=&#123;2&#125; password=&#123;3&#125; sslmode=&#123;4&#125;&quot;.format(host, user, dbname, password, sslmode)</span><br><span class="line">conn = psycopg2.connect(conn_string)</span><br><span class="line">print(&quot;Connection established&quot;)</span><br><span class="line"></span><br><span class="line">cursor = conn.cursor()</span><br><span class="line"></span><br><span class="line">nc = xr.open_dataset(&#x27;YOURFILE.nc&#x27;)</span><br><span class="line"># é€™æ­¥æœƒæŠŠ nan éæ¿¾æ‰</span><br><span class="line">nc.yourvariable.to_dataframe().dropna(subset=[&#x27;yourvariable&#x27;]).to_csv(&#x27;YOURFILE.csv&#x27;)</span><br><span class="line"></span><br><span class="line">csv_file_name = &#x27;C:\\test\\YOURFILE.csv&#x27;</span><br><span class="line">sql = &quot;COPY test(time, lat, lon, yourvariable) FROM &#x27;C:\\test\\YOURFILE.csv&#x27; DELIMITER &#x27;,&#x27; CSV HEADER;&quot;</span><br><span class="line">cursor.copy_expert(sql, open(csv_file_name, &quot;r&quot;))</span><br><span class="line">conn.commit()</span><br><span class="line"></span><br><span class="line">cursor.close()</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>

<h3 id="ç¹ªåœ–"><a href="#ç¹ªåœ–" class="headerlink" title="ç¹ªåœ–"></a>ç¹ªåœ–</h3><p>ä»¥å¾€éƒ½æ˜¯ç™¼æˆ wms äº‹æƒ…å°±çµæŸäº† , ç¹ªåœ–åŸºæœ¬ä¸Šæ²’å¤ªå¤šç ”ç©¶ , æš«æ™‚ç°¡å–®è¨˜éŒ„ä¸‹ , æœ‰ç©ºç ”ç©¶çœ‹çœ‹èƒ½å¦åŠ ä¸Š Georeferencing</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># æœ€åŸºæœ¬ç•«æ³•</span><br><span class="line">nc.chl[0].plot()</span><br><span class="line"></span><br><span class="line"># å¯ä»¥é€™æ¨£é—œé–‰ lon lat æ ¼ç·š</span><br><span class="line">plt.axis(&quot;off&quot;)</span><br><span class="line"></span><br><span class="line"># æ‰¾é€²éšåƒæ•¸</span><br><span class="line"># https://docs.xarray.dev/en/stable/generated/xarray.plot.pcolormesh.html</span><br><span class="line"></span><br><span class="line"># æ‰¾ colormap</span><br><span class="line"># https://matplotlib.org/stable/gallery/color/colormap_reference.html</span><br><span class="line">nc.chl[0].plot(robust=True , add_colorbar=False ,cmap=&#x27;rainbow&#x27;, add_labels = False)</span><br><span class="line"></span><br><span class="line"># ä¿å­˜åœ–ç‰‡ä¸å¸¶é‚Šæ¡†æ»¿ç‰ˆ</span><br><span class="line">plt.savefig(&#x27;save.png&#x27;, bbox_inches=&#x27;tight&#x27;,pad_inches = 0, transparent=True)</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/GIS/" rel="tag"># GIS</a>
              <a href="/tags/python/" rel="tag"># python</a>
              <a href="/tags/netcdf/" rel="tag"># netcdf</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/chrome-%E5%A4%9A%E8%AA%9E%E7%B3%BB%E5%9C%B0%E9%9B%B7/" rel="prev" title="chrome å¤šèªç³»åœ°é›·">
      <i class="fa fa-chevron-left"></i> chrome å¤šèªç³»åœ°é›·
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/%E6%88%91%E7%9A%84%E9%96%8B%E7%99%BC%E7%92%B0%E5%A2%832022/" rel="next" title="æˆ‘çš„é–‹ç™¼ç’°å¢ƒ2022">
      æˆ‘çš„é–‹ç™¼ç’°å¢ƒ2022 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®éŒ„
        </li>
        <li class="sidebar-nav-overview">
          æœ¬ç«™æ¦‚è¦
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%92%B0%E5%A2%83%E6%BA%96%E5%82%99"><span class="nav-number">1.</span> <span class="nav-text">ç’°å¢ƒæº–å‚™</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8B%E8%BC%89-Panpoly"><span class="nav-number">1.1.</span> <span class="nav-text">ä¸‹è¼‰ Panpoly</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%9D%E5%8F%8A%E8%A8%AD%E5%AE%9A-OpenJDK11"><span class="nav-number">1.2.</span> <span class="nav-text">å®‰è£åŠè¨­å®š OpenJDK11</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Panpoly-%E6%93%8D%E4%BD%9C%E8%AA%AA%E6%98%8E"><span class="nav-number">1.3.</span> <span class="nav-text">Panpoly æ“ä½œèªªæ˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#conda-%E6%BA%96%E5%82%99"><span class="nav-number">1.4.</span> <span class="nav-text">conda æº–å‚™</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#example"><span class="nav-number">2.</span> <span class="nav-text">example</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%AF%E5%87%BA%E7%82%BA-csv"><span class="nav-number">2.1.</span> <span class="nav-text">åŒ¯å‡ºç‚º csv</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%88%E4%BD%B5-netcdf"><span class="nav-number">2.2.</span> <span class="nav-text">åˆä½µ netcdf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E5%BE%A9%E6%99%82%E9%96%93-Coordinates"><span class="nav-number">2.3.</span> <span class="nav-text">ä¿®å¾©æ™‚é–“ Coordinates</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E5%BE%A9%E6%99%82%E9%96%93-Coordinates-part2"><span class="nav-number">2.4.</span> <span class="nav-text">ä¿®å¾©æ™‚é–“ Coordinates part2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E5%BE%A9-Coordinate-%E4%B8%A6%E9%99%8D%E7%B6%AD"><span class="nav-number">2.5.</span> <span class="nav-text">ä¿®å¾© Coordinate ä¸¦é™ç¶­</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E5%BE%A9-Coordinate-%E4%B8%A6%E4%B8%94%E8%A3%9C%E4%B8%8A-units"><span class="nav-number">2.6.</span> <span class="nav-text">ä¿®å¾© Coordinate ä¸¦ä¸”è£œä¸Š units</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%AF%E5%85%A5-netcdf-%E8%B3%87%E6%96%99%E5%88%B0-postgresql"><span class="nav-number">2.7.</span> <span class="nav-text">åŒ¯å…¥ netcdf è³‡æ–™åˆ° postgresql</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B9%AA%E5%9C%96"><span class="nav-number">2.8.</span> <span class="nav-text">ç¹ªåœ–</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ğŸŒ¹ å–‡è³½äºº ğŸŒ¹"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">ğŸŒ¹ å–‡è³½äºº ğŸŒ¹</p>
  <div class="site-description" itemprop="description">ğŸŒ¹ å–‡è³½äººçš„ Blog ğŸŒ¹</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">341</span>
          <span class="site-state-item-name">æ–‡ç« </span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">120</span>
        <span class="site-state-item-name">æ¨™ç±¤</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/weber87na" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;weber87na" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

	  <!-- skilltree å»£å‘Š -->
	  <div id="myadblock" style="margin-top:25px;position:relative">
	  <div id="myadblock-title" style="position:absolute;left:-10px;top:-10px;width:100px;background-color:rgba(0,0,0,.75);color:white;">å·æ”¾å·¥å•†</div>
	  <script src="https://skilltree.my/promotion/cec9b4b0-be5e-4727-85c6-f7af5445124a?w=350"></script>
	  </div>

	  <!-- google å»£å‘Š -->
	  <!--
	  <ins class="adsbygoogle"
		  style="display:inline-block;width:220px;height:120px;margin-top:50px;position:relative;border-bottom-left-radius: 15px 255px;border-bottom-right-radius: 225px 15px;border-top-left-radius: 255px 15px;border-top-right-radius: 15px 225px;border: 2px solid #41403e;"
		  data-ad-client="ca-pub-1069539516107706"
		  data-ad-slot="6588270137">
	  <div id="myadblock-title2" style="z-index:999999;position:absolute;left:-10px;top:-10px;width:100px;background-color:rgba(0,0,0,.75);color:white;">å·æ”¾å·¥å•†</div>
	  </ins>
	  <script>
		  (adsbygoogle = window.adsbygoogle || []).push({});
	  </script>
	  -->

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2026</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">å–‡è³½çš„äºº! G__G+</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">ç¸½å»¢è©±å­—æ•¸ï¼š</span>
    <span title="ç¸½å»¢è©±å­—æ•¸">1.7m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">æ‰€éœ€ç¸½æµªè²»æ™‚é–“ &asymp;</span>
    <span title="æ‰€éœ€ç¸½æµªè²»æ™‚é–“">25:58</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://la-sai-de-ren.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://www.blog.lasai.com.tw/posts/python-%E6%93%8D%E4%BD%9C-netcdf-%E7%AD%86%E8%A8%98/";
    this.page.identifier = "posts/python-æ“ä½œ-netcdf-ç­†è¨˜/";
    this.page.title = "python æ“ä½œ netcdf ç­†è¨˜";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://la-sai-de-ren.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>


  <!-- <div class="snow1" style="position:fixed !important"></div> -->
  <div class="cobweb" style="position:fixed !important"></div>
  <div class="spider" style="position:fixed !important"></div>
<div class="fswitch">é—œé–‰</div>
<div class="snowflakes" aria-hidden="true">
  <div class="snowflake">
 ğŸŒ¹
  </div>
  <div class="snowflake">
 ğŸ’©
  </div>
  <div class="snowflake">
 ğŸŒ¹
  </div>
  <div class="snowflake">
 ğŸ’©
  </div>
    <div class="snowflake">
 ğŸŒ¹
  </div>
  <div class="snowflake">
 ğŸ’©
  </div>
    <div class="snowflake">
 ğŸŒ¹
  </div>
  <div class="snowflake">
 ğŸ’©
  </div>
</div>

<!--
<script>
	function toggleSpell() {
		let spell = document.getElementsByClassName('spell')[0];
		let ghost = document.getElementsByClassName('ghost')[0];
		let noise = document.getElementsByClassName('noise')[0];
		let noise2 = document.getElementsByClassName('noise2')[0];
		if (spell.style.display === 'none') {
			spell.style.display = 'block';
			noise.style.display = '';
			noise2.style.display = '';
			ghost.style.display = 'none';
		} else {
			spell.style.display = 'none';
			noise.style.display = 'none';
			noise2.style.display = 'none';
			ghost.style.display = 'block';
		}
	}

	//è¨‚é–±å…§å®¹
	let spell = document.getElementsByClassName('spell')[0];
	let ghost = document.getElementsByClassName('ghost')[0];
	spell.addEventListener('click',toggleSpell);
	ghost.addEventListener('click',toggleSpell);
</script>
-->

<script>

let cobweb = document.querySelector('.cobweb');
let spider = document.querySelector('.spider');
let back = document.querySelector('.back-to-top');
let fswitch = document.querySelector('.fswitch');

document.addEventListener('keydown', function(event) {
	if (event.key === 'f') {
		console.log('press f key');
		ftoggle();
	}
});

fswitch.addEventListener('click' , function(){ 
	ftoggle();
});

function ftoggle(){
	if(cobweb.style.display === ''){
		cobweb.style.display = 'none';
	}else{
		cobweb.style.display = '';
	}
	if(spider.style.display === ''){
		spider.style.display = 'none';
	}else{
		spider.style.display = '';
	}
	if(back.style.display === ''){
		back.style.display = 'none';
	}else{
		back.style.display = '';
	}

	if(fswitch.innerText === 'é—œé–‰') fswitch.innerText = 'ä¹–ä¹–'
	else fswitch.innerText = 'é—œé–‰'
}



</script>

<script>
class ViNavigation {
  constructor() {
    this.Mode = {
      Normal: "normal",
      Motion: "motion",
    };

    this.lastKeyPressTime = 0;
    this.lastKeyPressed = "";
    this.currentMode = this.Mode.Normal;

    //å¯ä½¿ç”¨ç§»å‹•çš„å­—ç¢¼
    //å…± 18 å€‹å­— æ’é™¤ vi æœƒç”¨åˆ°çš„å­—
    this.tagChars = "ABCEILNOPQRSTVWXYZ";

    //ç›®å‰çš„ vim æ¨™ç¤ºå­—æ¨™ç±¤ array
    this.holdTags = new Array();

    //é å…ˆå»ºç«‹å…©å­—çµ„åˆçš„å­—å…¸
    this.dict = new Array();
    //é›™å±¤è¿´åœˆçŒå…¥æ‰€æœ‰å…©å­—çµ„åˆ
    for (var i = 0; i < this.tagChars.length; i++) {
      for (var j = 0; j < this.tagChars.length; j++) {
        this.dict.push(this.tagChars[i] + this.tagChars[j]);
      }
    }
  }

  viGoTop(keyPressed) {
    if (keyPressed === "g") {
      window.scrollTo({ top: 0, behavior: "smooth" });
    }
  }

  viGoBottom(keyPressed) {
    if (keyPressed === "G") {
      console.log("document.body.scrollHeight", document.body.scrollHeight);
      let h = Math.max(
        Math.max(
          document.body.scrollHeight,
          document.documentElement.scrollHeight
        ),
        Math.max(
          document.body.offsetHeight,
          document.documentElement.offsetHeight
        ),
        Math.max(
          document.body.clientHeight,
          document.documentElement.clientHeight
        )
      );
      window.scrollTo({ top: h, behavior: "smooth" });
    }
  }

  viFastDown(keyPressed) {
    if (keyPressed === "d") {
      this.move(350);
    }
  }

  viDown(keyPressed) {
    if (keyPressed === "j") {
      this.move(100);
    }
  }

  viFastUp(keyPressed) {
    if (keyPressed === "u") {
      this.move(-350);
    }
  }

  viUp(keyPressed) {
    if (keyPressed === "k") {
      this.move(-100);
    }
  }

  move(val) {
    var currentPosition =
      window.pageYOffset || document.documentElement.scrollTop;
    window.scrollTo({
      top: currentPosition + val,
      behavior: "smooth",
    });
  }

  removeViTags() {
    let allTags = document.querySelectorAll(".vim-tag");
    allTags.forEach(function (tag) {
      tag.parentNode.removeChild(tag);
    });
  }

  createViTag(text, href, top, left) {
    let newDiv = document.createElement("div");
    newDiv.classList.add("vim-tag");
    newDiv.style.fontFamily = "Arial, sans-serif";
    newDiv.style.fontSize = "12px";
    newDiv.style.position = "absolute";
    newDiv.style.backgroundColor = "#89CF07";
    newDiv.style.color = "black";
    newDiv.style.padding = "2px";
    newDiv.style.borderRadius = "2px";
    newDiv.style.zIndex = "999999";

    newDiv.textContent = text;
    newDiv.dataset.href = href;
    newDiv.style.top = top;
    newDiv.style.left = left;
    return newDiv;
  }

  createViTags() {
    let allTags = document.querySelectorAll("a");
    let counter = 0;
    for (let tag of allTags) {
      let rect = tag.getBoundingClientRect();
      let href = tag.href;
      //é€™å€‹è·é›¢éœ€è¦åŠ å…¥å·è»¸è·é›¢æ‰æœƒæ­£ç¢º
      let top = window.scrollY + rect.top + "px";
      let left = window.scrollX + rect.left + "px";
      let text = "";
      if (allTags.length <= this.tagChars.length) {
        text = this.tagChars[counter];
        this.holdTags.push(text);
      } else {
        text = this.dict[counter];
        this.holdTags.push(text);
      }
      let newDiv = this.createViTag(text, href, top, left);
      document.body.appendChild(newDiv);
      counter++;
    }
  }

  //æ‰¾å‡ºç›®å‰çš„é¦–å­— array
  firstCharArray() {
    let result = [];
    for (let i = 0; i < this.holdTags.length; i++) {
      let text = this.holdTags[i];
      if (text) {
        let theChar = text[0].toLowerCase();
        if (result.includes(theChar) === false) {
          result.push(theChar);
        }
      }
    }

    return result;
  }

  toggleMotion() {
    this.currentMode = this.Mode.Motion;
    this.lastKeyPressed = "";
    console.log("mode", this.currentMode);
    this.createViTags();
  }

  toggleNormal() {
    this.currentMode = this.Mode.Normal;
    console.log("mode", this.currentMode);
    this.removeViTags();
    this.holdTags = [];
    this.lastKeyPressed = "";
  }

  handleKeyDown(event) {
    let currentTime = new Date().getTime();
    let keyPressed = event.key;

    //æŒ‰ä¸‹ F æ™‚é€²å…¥ motion æ¨¡å¼
    if (this.currentMode === this.Mode.Normal && keyPressed === "F") {
      this.toggleMotion();
      return;
    }

    //æŒ‰ä¸‹ esc è·³é›¢ motion æ¨¡å¼å›åˆ° normal æ¨¡å¼
    if (this.currentMode === this.Mode.Motion && keyPressed === "Escape") {
      this.toggleNormal();
      return;
    }

    //ç•¶ motion ä¸€å€‹å­—æ™‚æ‰èµ°é€™æ¨¡å¼
    if (
      this.currentMode === this.Mode.Motion &&
      document.querySelectorAll("a").length <= this.tagChars.length &&
      this.tagChars.toLowerCase().includes(keyPressed)
    ) {
      console.log("one char mode");
      let allTags = document.querySelectorAll(".vim-tag");

      allTags.forEach(function (tag) {
        if (tag.textContent.toLowerCase() === keyPressed) {
          window.location.href = tag.dataset.href;
        }
      });

      this.toggleNormal();
      return;
    }

    //ç•¶ motion å…©å€‹å­—æ‰èµ°é€™å€‹æ¨¡å¼
    if (
      this.currentMode === this.Mode.Motion &&
      document.querySelectorAll("a").length > this.tagChars.length
    ) {
      console.log("motion lastKeyPressed", this.lastKeyPressed);
      console.log("motion current", keyPressed);

      if (!this.lastKeyPressed) {
        //å¦‚æœå‡ºç¾å­—è¡¨ä»¥å¤–çš„å­—å‰‡å›åˆ° normal
        //console.log("firstCharArray", this.firstCharArray());
        if (this.firstCharArray().includes(keyPressed) === false) {
          this.toggleNormal();
          return;
        } else {
          let allTags = document.querySelectorAll(".vim-tag");
          allTags.forEach(function (tag) {
            if (tag.textContent[0].toLowerCase() !== keyPressed) {
              tag.parentNode.removeChild(tag);
            }

            //å°‡ç¬¬ä¸€å€‹å­—è®Šç‚ºç´…è‰²
            if (tag.textContent[0].toLowerCase() === keyPressed) {
              tag.innerHTML =
                '<span style="color: red;">' +
                tag.textContent.charAt(0) +
                "</span>" +
                tag.textContent.substring(1);
            }
          });
        }
      }

      //å¦‚æœæœ‰å­—çš„è©±æ‰åŸ·è¡Œ
      if (this.lastKeyPressed) {
        let chars = this.lastKeyPressed + keyPressed;
        console.log("chars", chars);
        let allTags = document.querySelectorAll(".vim-tag");
        allTags.forEach(function (tag) {
          if (tag.textContent.toLowerCase() === chars) {
            window.location.href = tag.dataset.href;
          }
        });
        //è¬ä¸€æ²’æ‰¾åˆ°åˆ‡å› Normal
        this.toggleNormal();
        return;
      }
    }

    // ä»»ä½•æ¨¡å¼æŒ‰å…©ä¸‹çš„å€åŸŸ
    if (
      keyPressed === this.lastKeyPressed &&
      currentTime - this.lastKeyPressTime < 300
    ) {
      this.viGoTop(keyPressed);
    }

    // æŒ‰ä¸€ä¸‹çš„å€åŸŸ
    this.viGoBottom(keyPressed);
    this.viDown(keyPressed);
    this.viFastDown(keyPressed);
    this.viUp(keyPressed);
    this.viFastUp(keyPressed);

    this.lastKeyPressTime = currentTime;
    this.lastKeyPressed = keyPressed;
  }

  init() {
    document.addEventListener("keydown", this.handleKeyDown.bind(this));
  }
}

const viNavigation = new ViNavigation();
viNavigation.init();
</script>



</body>
</html>
