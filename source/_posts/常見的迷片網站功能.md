---
title: 常見的迷片網站功能
date: 2022-02-15 19:25:32
tags:
---
&nbsp;
![賽](https://raw.githubusercontent.com/weber87na/flowers/master/15.jpg)
<!-- more -->

### 關閉 window 時跳出煩人的訊息
這類網站通常會跳一堆 window 出來 , 然後又搞個你中獎了或是中毒了之類的訊息
主要通過 `beforeunload` 這個 event , 然後進行客製化的控制 , 大概會長這樣
```
window.onbeforeunload = function() {
	return '離開此頁?';

}
```

或是這樣寫
```
window.addEventListener('beforeunload', function (e) {
    e.preventDefault();
    e.returnValue = '';
});
```

在 chrome 51 以前 , 如果你的網頁有狀態概念可以運用這樣防止使用者忘了存檔
不過 google 為了防止這類的詐騙? 已經不能自訂訊息 , 會直接給你預設的訊息
可以參考[這個討論看看](https://stackoverflow.com/questions/4802007/window-onbeforeunload-not-working-in-chrome)
```
window.onbeforeunload = function() {
	if(status === 1){
		return '離開此頁?';
	}
}
```


### 蓋板廣告
這個功能很常見 , 通常會故意把關閉的 icon 設計讓你點下去也關不掉 , 或是點下去又跳其他 window 出來 , 大概類似這樣寫
反正就是將 css 的 `position` 設定為 `fixed` 接著置中 , 然後設定一個接近全螢幕的範圍即可
```
var panel = document.createElement('div');
panel.style.height = '500px';
panel.style.width = '500px';
panel.style.position = 'fixed';
panel.style.top = 'calc(50% - 250px)';
panel.style.left = 'calc(50% - 250px)';
panel.style.backgroundColor = '#fff';
panel.style.border = 'solid 1px #dedede';
panel.style.zIndex = "9999";
document.body.appendChild(panel);
var closeButton = document.createElement('p');
closeButton.style.textAlign = 'center';
closeButton.innerHTML = '<a href="javascript:;">Close</a>';
closeButton.style.backgroundColor = '#fa0';
closeButton.style.fontSize = '36px';
closeButton.style.padding = '20px';
closeButton.style.right = '0px';
closeButton.style.top = '0px';

panel.appendChild(closeButton);
closeButton.addEventListener('click', function () {
    panel.parentNode.removeChild(panel)
});
```

### 嵌入廣告 方法 1
一直以來都很賭爛 `iframe` 這個神祕的 tag , 很常在 3rd 廣告上看到使用他的蹤影 , 做謎片的朋友也想開放這個功能擺在其他網站上 , 所以玩看看
```
var html = `
<html>
<head>
    <style>
    *{
        margin:0;
        padding:0;
        overflow: hidden;
    }
    </style>
</head>
<body>
<img src="https://raw.githubusercontent.com/weber87na/flowers/master/15.jpg"  height="100%" alt=""></img>
</body>
</html>
`;

var iframe = document.createElement('iframe');
iframe.src = 'data:text/html;charset=utf-8,' + encodeURI(html);
iframe.frameBorder = 0;
document.body.appendChild(iframe);
```

然後隨便找個地方加上去就搞定
```
    <script src="test.js"></script>
```

此外印象中之前有學過等比例影片 , 不過現在也忘光光 , 大概可以參考[這篇](https://ithelp.ithome.com.tw/articles/10252882)

### 嵌入廣告 方法 2
後來想一想如果只放圖片的話 , 其實這樣寫就好了
```
document.write(`<a target='_blank' href="https://weber87na.github.io/"><img src="https://raw.githubusercontent.com/weber87na/flowers/master/15.jpg" width="300" alt=""/></a>`);
```

一樣無腦引用即可
```
    <script src="test.js"></script>
```
